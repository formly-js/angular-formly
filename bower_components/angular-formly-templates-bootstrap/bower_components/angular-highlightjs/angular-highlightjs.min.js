/*! angular-highlightjs
version: 0.3.3
build date: 2015-01-11
author: Robin Fan
https://github.com/pc035860/angular-highlightjs.git */
!function(a){function b(a){var b=!0;return angular.forEach(["source","include"],function(c){a[c]&&(b=!1)}),b}var c,d,e,f;a.provider("hljsService",function(){var a={};return{setOptions:function(b){angular.extend(a,b)},getOptions:function(){return angular.copy(a)},$get:["$window",function(b){return(b.hljs.configure||angular.noop)(a),b.hljs}]}}).factory("hljsCache",["$cacheFactory",function(a){return a("hljsCache")}]).controller("HljsCtrl",["hljsCache","hljsService",function(a,b){var c=this,d=null,e=null,f=null,g=null;c.init=function(a){d=a},c.setLanguage=function(a){e=a,f&&c.highlight(f)},c.highlightCallback=function(a){g=a},c.highlight=function(h){if(d){var i,j;f=h,e?(j=c._cacheKey(e,f),i=a.get(j),i||(i=b.highlight(e,b.fixMarkup(f),!0),a.put(j,i))):(j=c._cacheKey(f),i=a.get(j),i||(i=b.highlightAuto(b.fixMarkup(f)),a.put(j,i))),d.html(i.value),d.addClass(i.language),null!==g&&angular.isFunction(g)&&g()}},c.clear=function(){d&&(f=null,d.text(""))},c.release=function(){d=null},c._cacheKey=function(){var a=Array.prototype.slice.call(arguments),b="!angular-highlightjs!";return a.join(b)}}]),c=["$compile","$parse",function(a,c){return{restrict:"EA",controller:"HljsCtrl",compile:function(d){var e=d[0].innerHTML.replace(/^(\r\n|\r|\n)/m,""),f=d[0].textContent.replace(/^(\r\n|\r|\n)/m,"");return d.html('<pre><code class="hljs"></code></pre>'),function(d,g,h,i){var j,k;if(angular.isDefined(h.compile)&&(j=c(h.compile)),angular.isDefined(h.escape)?k=c(h.escape):angular.isDefined(h.noEscape)&&(k=c("false")),i.init(g.find("code")),h.onhighlight&&i.highlightCallback(function(){d.$eval(h.onhighlight)}),(e||f)&&b(h)){var l;l=k&&!k(d)?f:e,i.highlight(l),j&&j(d)&&a(g.find("code").contents())(d)}d.$on("$destroy",function(){i.release()})}}}}],d=function(a){return[function(){return{require:"?hljs",restrict:"A",link:function(b,c,d,e){e&&d.$observe(a,function(a){angular.isDefined(a)&&e.setLanguage(a)})}}}]},e=function(a){return["$compile","$parse",function(b,c){return{require:"?hljs",restrict:"A",link:function(d,e,f,g){var h;g&&(angular.isDefined(f.compile)&&(h=c(f.compile)),d.$watch(f[a],function(a){a?(g.highlight(a),h&&h(d)&&b(e.find("code").contents())(d)):g.clear()}))}}}]},f=function(a){return["$http","$templateCache","$q","$compile","$parse",function(b,c,d,e,f){return{require:"?hljs",restrict:"A",compile:function(g,h){var i=h[a];return function(a,g,h,j){var k,l=0;j&&(angular.isDefined(h.compile)&&(k=f(h.compile)),a.$watch(i,function(f){var h=++l;if(f&&angular.isString(f)){var i,m;i=c.get(f),i||(m=d.defer(),b.get(f,{cache:c,transformResponse:function(a){return a}}).success(function(a){h===l&&m.resolve(a)}).error(function(){h===l&&j.clear(),m.resolve()}),i=m.promise),d.when(i).then(function(b){b&&(angular.isArray(b)?b=b[1]:angular.isObject(b)&&(b=b.data),b=b.replace(/^(\r\n|\r|\n)/m,""),j.highlight(b),k&&k(a)&&e(g.find("code").contents())(a))})}else j.clear()}))}}}}]},a.directive("hljs",c).directive("language",d("language")).directive("source",e("source")).directive("include",f("include"))}(angular.module("hljs",[]));